---
import { ArrowRight, Calendar, Clock, MapPin } from "lucide-react";
import type { Event } from "@/lib/events";

interface Props {
  event: Event;
}

const { event } = Astro.props;

const startDate = new Date(event.start_time);
const endDate = new Date(event.end_time);
const dateKey = (date: Date) =>
  date.toLocaleDateString("en-US", {
    timeZone: "America/Los_Angeles",
    year: "numeric",
    month: "2-digit",
    day: "2-digit",
  });
const isMultiDay = dateKey(startDate) !== dateKey(endDate);

const formattedStartDate = startDate.toLocaleDateString("en-US", {
  weekday: "long",
  month: "long",
  day: "numeric",
  year: "numeric",
  timeZone: "America/Los_Angeles",
});
const formattedEndDate = endDate.toLocaleDateString("en-US", {
  weekday: "long",
  month: "long",
  day: "numeric",
  year: "numeric",
  timeZone: "America/Los_Angeles",
});
const formattedDate = isMultiDay
  ? `${formattedStartDate} - ${formattedEndDate}`
  : formattedStartDate;

const formattedStartTime = startDate.toLocaleTimeString("en-US", {
  hour: "numeric",
  minute: "2-digit",
  timeZone: "America/Los_Angeles",
});

const formattedEndTime = endDate.toLocaleTimeString("en-US", {
  hour: "numeric",
  minute: "2-digit",
  timeZone: "America/Los_Angeles",
});
---

<header class="mb-8">
  <h1 class="font-serif text-3xl font-bold tracking-tight text-foreground md:text-4xl lg:text-5xl leading-tight">
    {event.title}
  </h1>
</header>

<div class="flex flex-col gap-4 mb-10 pb-10 border-b border-border/50">
  <div class="flex items-center gap-3 text-foreground">
    <div class="flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-primary/10">
      <Calendar className="h-5 w-5 text-primary" />
    </div>
    <span class="text-base font-medium">{formattedDate}</span>
  </div>

  <div class="flex items-center gap-3 text-foreground">
    <div class="flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-primary/10">
      <Clock className="h-5 w-5 text-primary" />
    </div>
    <span class="text-base font-medium">
      {event.is_all_day
        ? "All Day"
        : isMultiDay
          ? `${formattedStartTime} – ${formattedEndDate}, ${formattedEndTime}`
          : `${formattedStartTime} – ${formattedEndTime}`}
    </span>
  </div>

  <div class="flex items-center gap-3 text-foreground">
    <div class="flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-primary/10">
      <MapPin className="h-5 w-5 text-primary" />
    </div>
    <span class="text-base font-medium">{event.location}</span>
  </div>
</div>

{event.description && (
  <section class="flex-1">
    <h2 class="text-sm font-semibold uppercase tracking-widest text-muted-foreground mb-4">
      About this event
    </h2>
    <div class="text-base leading-relaxed text-foreground/90 whitespace-pre-wrap">
      {event.description}
    </div>
  </section>
)}

<footer class="mt-12 pt-8 border-t border-border/50">
  <p class="text-muted-foreground mb-3">We hope to see you there!</p>
  <a
    href="/events"
    class="inline-flex items-center gap-2 text-primary font-medium hover:underline underline-offset-4"
  >
    View all upcoming events
    <ArrowRight className="h-4 w-4" />
  </a>
</footer>
